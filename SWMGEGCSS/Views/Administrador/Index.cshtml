
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutEmpresa.cshtml";
}

<div class="container">
    <h2 class="font-weight-bolder">Notificaciones</h2>
    <div id="notificacion">

    </div>
</div>
@section scripts{
    <script src="~/Scripts/jquery.signalR-2.2.2.js"></script>
    <script src="/signalr/hubs"></script>
    <script type="text/javascript">
        $(function () {
            var notifications = $.connection.messagesHub;
            notifications.client.updateMessages= function () {
                sp_Consultar_Notificaciones()
            }
            $.connection.hub.start().done(function () {
                sp_Consultar_Notificaciones();
            }).fail(function (e) {
                alert(e);
            });

            function sp_Consultar_Notificaciones() {
                var tb = $("#notificacion");
                $.ajax({
                    url: "/Gerente/ObtenerNotificaciones",
                    contentType: "application/html;charset: utf-8",
                    type: "GET",
                    data: {
                        usu_codigo:@Session["login"]
                    },
                    dataType: "html",
                    cache: false
                }).done(function (data) {
                    tb.empty().append(data);
                }).fail(function () {

                });
            }
        });
    </script>
}




